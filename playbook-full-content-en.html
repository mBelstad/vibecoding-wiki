<h1 id="vibecoding-playbook-cursor-opussonnet-full-version">Vibecoding Playbook (Cursor + Opus/Sonnet) — Full Version</h1>

<blockquote>Goal: Keep the speed of vibecoding, but make the project safe, predictable, and ship-ready.</blockquote>

<h2 id="contents">Contents</h2>
<ul>
<li><a href="#principles">Principles</a></li>
<li><a href="#project-structure-minimal-but-strict">Project Structure (minimal but strict)</a></li>
<li><a href="#source-of-truth-and-governance-documents">Source of truth and governance documents</a></li>
<li><a href="#roles-you--ai">Roles (you + AI)</a></li>
<li><a href="#project-phases">Project Phases</a></li>
<li><a href="#non-negotiables-vs-negotiables">Non-negotiables vs negotiables</a></li>
<li><a href="#hygiene-routines">Hygiene Routines</a></li>
<li><a href="#new-chat-and-handoff">New Chat and Handoff</a></li>
<li><a href="#agent-mode-definition-of-done">Agent-mode Definition of Done</a></li>
<li><a href="#prompt-templates-per-role">Prompt Templates per Role</a></li>
<li><a href="#document-templates-adr-experiment-runbooks">Document Templates (ADR, experiment, runbooks)</a></li>
<li><a href="#debugging-anti-bombastic-rules">Debugging: anti-bombastic rules</a></li>
</ul>

<hr>

<h2 id="principles">Principles</h2>

<h3 id="efficient-and-safe-control-surfaces">Efficient and safe = "control surfaces"</h3>
<p>You want:</p>
<ol>
<li><strong>One truth</strong> about goals and decisions (brief + ADRs)</li>
<li><strong>Separation between prototype and production code</strong></li>
<li><strong>Automatic rails</strong> (lint/test/CI) that catch errors early</li>
<li><strong>Measurable hypotheses</strong> when debugging</li>
</ol>

<h3 id="things-you-should-do-yourself-without-ai">Things you should do yourself (without AI)</h3>
<ul>
<li><strong>Prioritization / scope</strong></li>
</ul>
<p>  - What is v1? What is v2? What gets cut?</p>
<ul>
<li><strong>Security/access control and "go/no-go"</strong></li>
</ul>
<p>  - Secrets, auth, payment flows, exposed ports, compliance.</p>
<ul>
<li><strong>Final architecture decisions</strong></li>
</ul>
<p>  - AI can suggest, but you make the decision and write the "decision record".</p>
<ul>
<li><strong>Critical debugging with "ground truth"</strong></li>
</ul>
<p>  - When observations are few or contradictory: you control the measurements/logs.</p>
<ul>
<li><strong>Contract/acceptance criteria</strong></li>
</ul>
<p>  - "What does done mean?" must be human-defined.</p>

<hr>

<h2 id="project-structure-minimal-but-strict">Project Structure (minimal but strict)</h2>

<p><strong>Root</strong></p>
<ul>
<li><code>README.md</code> (1 screen: what, how to run, link to brief)</li>
<li><code>docs/</code></li>
</ul>
<p>  - <code>00-Project-Brief.md</code> <em>(source of truth)</em></p>
<p>  - <code>01-NonNegotiables.md</code></p>
<p>  - <code>02-Architecture.md</code> <em>(high-level + diagram)</em></p>
<p>  - <code>03-ADRs/</code> <em>(short decisions)</em></p>
<p>  - <code>10-Backlog.md</code> <em>(or issues)</em></p>
<p>  - <code>20-Runbooks/</code> <em>(operations/errors, "what do I do when...")</em></p>
<p>  - <code>30-Experiments/</code> <em>(spikes with clear "result/conclusion")</em></p>
<p>  - <code>Context-Pack.md</code> <em>(AI entry point, always updated)</em></p>
<ul>
<li><code>prototype/</code> <em>(spikes, can be deleted)</em></li>
<li><code>app/</code> <em>(production code)</em></li>
<li><code>scripts/</code> <em>(tools, migration, hygiene)</em></li>
<li><code>.cursor/</code> <em>(project rules / memories / prompts)</em></li>
</ul>

<p><strong>Important rule:</strong>  </p>
<p>Markdown files should either be <strong>governance documents</strong> (brief/adr/runbook), or <strong>results</strong> (experiment report). Not "loose thoughts".</p>

<hr>

<h2 id="source-of-truth-and-governance-documents">Source of truth and governance documents</h2>

<h3 id="docs00-project-briefmd-always-updated">`docs/00-Project-Brief.md` (always updated)</h3>
<p>Contains:</p>
<ul>
<li><em>What are we building?</em></li>
<li><em>Who is the user?</em></li>
<li><em>Non-negotiables</em> (requirements you don't negotiate)</li>
<li><em>Negotiables</em> (things that can be deprioritized/changed)</li>
<li><em>Definition of Done</em> for v1</li>
<li><em>Risks/assumptions</em> (and how they are validated)</li>
</ul>

<h3 id="docscontext-packmd-ais-fixed-entry-point">`docs/Context-Pack.md` (AI's fixed entry point)</h3>
<p>Keep it short (max ~1–2 screens):</p>

<pre><code class="language-md"># Context Pack (always current)

## Status now
- What works:
- What is broken:
- Biggest risk right now:

## Current goal (this week)
- Primary goal:
- Deadline / milestone:
- Definition of Done (v1 slice):

## Non-negotiables
- Security constraints:
- Performance constraints:
- UX constraints:

## Known failures / do-not-repeat
- Tried X → failed because Y (link to logs/PR/commit):
- Tried A → caused regression B (link):

## Key entry points
- Main modules:
- Config files:
- CI / scripts:
- Runbooks:

## How to verify quickly
- Commands:
- URLs:
- Expected outputs:</code></pre>

<hr>

<h2 id="roles-you-ai">Roles (you + AI)</h2>

<h3 id="human-you">Human (you)</h3>
<ul>
<li>Product Owner: scope, v1-v2, priority, acceptance criteria</li>
<li>Tech Lead: architecture choices, standards, "no-go" on security</li>
<li>QA Lead: test strategy + which flows must be protected</li>
</ul>

<h3 id="ai-roles-you-call-them-explicitly-in-prompts">AI roles (you call them explicitly in prompts)</h3>
<p>1) <strong>Staff Engineer (plan + ADR)</strong>  </p>
<p>2) <strong>Implementer (agent)</strong>  </p>
<p>3) <strong>Refactor Sheriff</strong>  </p>
<p>4) <strong>SRE/DevOps</strong>  </p>
<p>5) <strong>QA/Test Engineer</strong>  </p>
<p>6) <strong>Debugger (thinking-only)</strong></p>

<hr>

<h2 id="project-phases">Project Phases</h2>

<h3 id="phase-0-rescue-mission-you-are-here-now">Phase 0: Rescue Mission (you are here now)</h3>
<p>Goal: get overview, stabilize, stop the bleeding.</p>
<ul>
<li>Create <code>00-Project-Brief.md</code> (1–2 pages)</li>
<li>Create <code>10-Backlog.md</code> and move "all mess" in as short items</li>
<li>Mark everything with: <code>KEEP</code> / <code>DELETE</code> / <code>MAYBE</code> / <code>REPLACE</code></li>
<li>Create a "Freeze-list": things AI can't touch without explicit task (auth, billing, infra, ingest pipeline, etc.)</li>
</ul>

<h3 id="phase-1-consolidation">Phase 1: Consolidation</h3>
<p>Goal: one way to do things.</p>
<ul>
<li>Standards (naming, folder conventions, lint, format, types)</li>
<li>ADRs for the 5 biggest choices (short)</li>
<li>Move "proto" to <code>prototype/</code> or "prod" to <code>app/</code> with tests</li>
</ul>

<h3 id="phase-2-v1-vertical-slices">Phase 2: V1 Vertical Slices</h3>
<p>Goal: complete user flows, not "many features".</p>
<ul>
<li>Top 3–5 critical flows</li>
<li>For each flow:</li>
</ul>
<p>  - Acceptance criteria (human)</p>
<p>  - Instrumentation/logging (SRE)</p>
<p>  - Implementation (agent)</p>
<p>  - Tests (QA)</p>
<p>  - Review (you)</p>

<h3 id="phase-3-hardening">Phase 3: Hardening</h3>
<p>Goal: withstands real use.</p>
<ul>
<li>Observability (metrics/logs/traces)</li>
<li>Security (secrets, RBAC, rate limiting)</li>
<li>Performance/regression tests for critical paths</li>
</ul>

<h3 id="phase-4-release-operations">Phase 4: Release & Operations</h3>
<p>Goal: shipping rhythm.</p>
<ul>
<li>Release notes</li>
<li>Runbooks</li>
<li>Bugfix lane</li>
</ul>

<hr>

<h2 id="non-negotiables-vs-negotiables">Non-negotiables vs negotiables</h2>

<h3 id="non-negotiables-examples">Non-negotiables (examples)</h3>
<ul>
<li>No secrets in repo</li>
<li>No feature without logging on critical path (when relevant)</li>
<li>No major change without test for critical logic (when relevant)</li>
<li>CI must be green before merge</li>
<li>ADR for big choices (1 page)</li>
</ul>

<h3 id="negotiables-examples">Negotiables (examples)</h3>
<ul>
<li>UI polish</li>
<li>Number of integrations in v1</li>
<li>Advanced dashboards</li>
<li>Auto-scaling / HA in v1</li>
</ul>

<hr>

<h2 id="hygiene-routines">Hygiene Routines</h2>

<h3 id="daily-1020-min">Daily (10–20 min)</h3>
<p>1) <strong>Inbox-to-backlog</strong> (not new markdown files)</p>
<p>2) <strong>Journal / experiment note</strong></p>
<p>3) <strong>Update Context-Pack</strong></p>

<h3 id="weekly-6090-min">Weekly (60–90 min)</h3>
<p>1) <strong>Cleanup: KEEP/DELETE/MAYBE</strong></p>
<p>2) <strong>Duplicate sweep</strong></p>
<p>3) <strong>ADR-sprint (max 3)</strong></p>

<h3 id="per-feature-pr">Per feature / PR</h3>
<ul>
<li>Acceptance criteria</li>
<li>Which files are "source of truth"</li>
<li>Which logs/metrics prove it works</li>
<li>Which tests protect this</li>
<li>Rollback plan</li>
</ul>

<hr>

<h2 id="new-chat-and-handoff">New Chat and Handoff</h2>

<h3 id="open-new-chat-when">Open new chat when…</h3>
<ul>
<li>Topic shifts (new feature/module)</li>
<li>Chat has become "polluted"</li>
<li>You need a new role (plan ↔ implement)</li>
<li>Debugging is stuck</li>
<li>Big cleanup / hardening</li>
</ul>

<h3 id="handoff-package-copypaste">Handoff package (copy/paste)</h3>
<pre><code class="language-text">Read docs/Context-Pack.md and docs/00-Project-Brief.md first.

Project state:
- Branch:
- Last known good commit/PR:
- Environment:

What we were doing:
- Goal:

What changed (paths):
- &lt;path&gt;: &lt;what changed&gt;

What is still broken / missing:
- Symptom:
  Evidence:
  Repro:

Known do-not-repeat:
- Tried X → failed because Y (link/log)
- Do NOT add dependencies or refactor broadly.

Task now:
- Next smallest step

Scope control:
- Allowed paths:
- Forbidden:

Non-negotiables:
- Minimal diffs, verify + rollback, no conclusions from single datapoint

Verification:
- Commands:
- Expected results:

Role: &lt;Debugger / Staff Engineer / Implementer / Refactor Sheriff / QA / SRE&gt;</code></pre>

<hr>

<h2 id="agent-mode-definition-of-done">Agent-mode Definition of Done</h2>

<pre><code class="language-text">- Acceptance criteria met (explicitly mapped).
- Minimal diff: no unrelated refactors.
- Code builds/starts; lint/format passes.
- Tests: added/updated for critical logic OR reason given why not.
- Logging/metrics: added where it reduces future debugging cost (optional but preferred on critical paths).
- Docs updated if behavior/config changed.
- No secrets committed; configs use env vars/templates.
- Verification steps provided (exact commands + expected result).
- Rollback steps provided (what to revert / feature flag / config toggle).
- Remaining risks listed with mitigation and next action.</code></pre>

<p>Hard stop (agent must ask):</p>
<ul>
<li>Delete/rename major modules</li>
<li>Security implications (auth/secrets)</li>
<li>New dependencies/infra</li>
<li>Broad rewrites not explicitly requested</li>
</ul>

<hr>

<h2 id="prompt-templates-per-role">Prompt Templates per Role</h2>

<h3 id="staff-engineer-opus-thinking">Staff Engineer (Opus Thinking)</h3>
<pre><code class="language-text">ROLE: Staff Engineer (planning + architecture + risk)
MODE: Thinking-only. No implementation.

Use ONLY facts from the repo. If missing context, propose assumptions explicitly.

INPUT:
- Context-Pack: (paste)
- Task: &lt;TASK&gt;
- Constraints: &lt;CONSTRAINTS&gt;
- Files to consider: &lt;PATHS&gt;

OUTPUT:
1) Problem statement
2) 2–3 options (tradeoffs)
3) Recommendation
4) Step-by-step plan (small PR steps)
5) Verification plan
6) Rollback plan
7) ADR draft (short)
8) Stop &amp; ask list</code></pre>

<h3 id="implementer-agent">Implementer (Agent)</h3>
<pre><code class="language-text">ROLE: Implementer (agent)
GOAL: Implement with minimal diff, safely.

Rules:
- No unrelated refactors.
- No new deps without ADR approval.
- Include verification and rollback.
- Update docs if behavior changes.

INPUT:
- Context-Pack
- Task
- Acceptance criteria
- Target files

DELIVERABLE:
1) Summary of changes
2) Commands to verify (+ expected result)
3) Rollback steps
4) New risks introduced
Stop and ask if: deletion/rename, security implication, deps, global refactor</code></pre>

<h3 id="refactor-sheriff">Refactor Sheriff</h3>
<pre><code class="language-text">ROLE: Refactor Sheriff
MODE: Conservative refactor. Safety first.

INPUT:
- Context-Pack
- Goal
- Scope limit: &lt;PATHS ONLY&gt;

OUTPUT:
1) Inventory: duplicates, dead code, unused files (paths)
2) KEEP/DELETE/MAYBE/REPLACE per item + reason
3) &quot;Golden path&quot; (which module survives)
4) Migration plan in 3–6 safe steps
5) Verification plan
6) Deletion policy: nothing deleted unless explicitly approved</code></pre>

<h3 id="qatest-engineer">QA/Test Engineer</h3>
<pre><code class="language-text">ROLE: QA/Test Engineer
INPUT:
- Context-Pack
- Feature/flow
- Acceptance criteria
- Existing tests (paths)

OUTPUT:
1) Risk-based test matrix
2) Recommended automated tests (unit/integration/e2e) with file targets
3) Minimal smoke test checklist (manual)
4) Test data/fixtures needed
5) Regression traps (known failures)</code></pre>

<h3 id="sredevops">SRE/DevOps</h3>
<pre><code class="language-text">ROLE: SRE/DevOps Engineer
INPUT:
- Context-Pack
- Objective
- Environment
- Current tooling (paths)

OUTPUT:
1) Current gaps (CI, secrets, logs, metrics, alerts)
2) Minimal plan to add &quot;rails&quot; without slowing dev
3) Proposed dashboards/log queries (if relevant)
4) Verification checklist
5) Rollback plan
No new infra/paid services without explicit approval.</code></pre>

<h3 id="debugger-thinking-only">Debugger (Thinking-only)</h3>
<pre><code class="language-text">ROLE: Debugger (root-cause)
MODE: Thinking-only. Do NOT implement changes yet.

INPUT:
- Symptom:
- Evidence:
- Context-Pack:
- Suspect files:

OUTPUT:
1) 3–5 hypotheses ranked (with confidence)
2) For each: what evidence would confirm/deny
3) The fastest discriminating tests (commands/log points)
4) Minimal fix plan once confirmed
Rule: do not conclude from a single datapoint; require 2 independent datapoints.</code></pre>

<hr>

<h2 id="document-templates-adr-experiment-runbooks">Document Templates (ADR, experiment, runbooks)</h2>

<h3 id="experiment-report">Experiment report</h3>
<p><code>docs/30-Experiments/YYYY-MM-DD-<topic>.md</code></p>
<pre><code class="language-md"># Experiment: &lt;topic&gt;
## Goal
## What we tried
## Evidence (links/logs)
## Result
## Conclusion (confidence %)
## Next step
## Do-not-repeat</code></pre>

<h3 id="adr">ADR</h3>
<p><code>docs/03-ADRs/ADR-000X-<name>.md</code></p>
<pre><code class="language-md"># ADR-000X: &lt;decision&gt;
## Context
## Decision
## Options considered
## Consequences
## Verification</code></pre>

<h3 id="runbook">Runbook</h3>
<p><code>docs/20-Runbooks/<issue>.md</code></p>
<pre><code class="language-md"># Runbook: &lt;issue&gt;
## Symptoms
## Quick checks
## Likely causes
## Fix steps (safe order)
## Verification
## Rollback
## Notes / links</code></pre>

<hr>

<h2 id="debugging-anti-bombastic-rules">Debugging: anti-bombastic rules</h2>
<p>Use "observation requirements" in prompts:</p>
<ul>
<li>"List 3 possible explanations, rank them, and say which log/command will distinguish them."</li>
<li>"Don't conclude before at least 2 independent datapoints."</li>
<li>"If you suggest a change, include how we verify and how we roll back."</li>
<li>"If unsure: hypotheses + test plan instead of large code changes."</li>
</ul>

